<?if($_REQUEST['default']) {	$gadget = $_SERVER['db']->getRow('SELECT * FROM gadgets WHERE id='.dbstr($_REQUEST['default']));		if(!$gadget['id']) redirect($_SESSION['lastPage'],'The Gadget you requestd could not be found!');		$_SERVER['db']->execute('UPDATE gadgets SET views = '.($gadget['views'] + 1).' WHERE id='.dbstr($_REQUEST['default']));		if($gadget['dataType'] == 'php') {		ob_start();		eval($gadget['data']);		$gadget['data'] = ob_get_clean();	}		$currentGadget = '		<div class="gadget footer currentgadget" href="/gadget-'.$gadget['id'].'"><a class="close lbtn back" href="/gadget">Close Gadget</a><div class="title">'.$gadget['title'].':</div><div class="desc">'.$gadget['tags'].'</div></div>	';	$content = /*'<div id="gadgetTitle">'.$gadget['title'].':</div>'.*/$gadget['data'];	$title = ': '.$gadget['title'];}else $currentGadget = '	<div class="nbox" style="margin-bottom:100px;">		<div class="bigtext">Welcome to the Gadget system!</div><div class="desc">Select a gadget from above</div>	</div>';$rs = $_SERVER['db']->execute('SELECT id, title, tags FROM gadgets WHERE hidden=0 ORDER BY views DESC');if ($rs) while ($gadget = $rs->FetchRow()) {	if($gadget['id'] != $_REQUEST['default']) $gadgets .= '<a class="gadget" href="/gadget-'.$gadget['id'].'"><div class="title">'.$gadget['title'].'</div><div class="desc">'.$gadget['tags'].'</div></a>';}setPageConst('title','Gadgets'.$title);setPage('<style type="text/css">#gadgets { height:70px; overflow:auto; font-size:9px; }#gadgets a { width:207px; float:left; }#gadgets a div { padding:3px; }#gadgets a .title { padding-bottom:0; }#gadget { text-align:center; padding:50px; padding-top:30px; }#filter { width:80%; float:right; }.currentgadget { text-align:center; padding:5px; }.currentgadget .close { float:left; margin-right:-120px; margin-top:1px; background:none; font-size:9px; }</style><script type="text/javascript">window.addEvent(\'domready\', function() {	$(\'filter\').addEvent(\'keyup\', function() {		val = $(\'filter\').value.toLowerCase();		$ES(\'a\',\'gadgets\').each(function(el) {			if(val == \'\' || el.className.match(\'close\')) var match = true;			else {				var match = false				$ES(\'div\',el).each(function(els) {					if((els.getText().toLowerCase().indexOf(val)) != -1) match = true;				});			}			if(match)	el.style.display = \'block\';			else		el.style.display = \'none\';		});	});});</script>','head');setPage('	<div class="header">	<input class="input" type="text" name="filter" id="filter" />	<div>Find:</div></div><div id="gadgets" class="content llst" style="'.($content ? '' : 'height:auto;').'">	'.$gadgets.'</div>'.$currentGadget.''.($content ? '<div id="gadget" class="content">	'.$content.'</div>' : '').'');?>