<?//************************************************************//*** This function returns a nice list of classified ads ****//** All you have to give it is the sql for finding them! ****//************************************************************function simplifiedClassifiedsList($ssql='',$fields='') { 	$sql = "SELECT a.id, a.title, a.price, a.thumb0, a.town, a.country, a.status, t.type, p.priceType ".$fields." FROM classifieds_ads a, classifieds_types t, classifieds_prices p WHERE a.type = t.typeId AND a.priceType = p.priceId AND status < 2".str_replace('storeid','a.storeid',$_SESSION['safarriStore']['sql']).' '.$ssql;		$rs = $_SERVER['db']->execute($sql);	if ($rs) {		while ($ad = $rs->FetchRow()) {			(($counter++ % 2) == 0) ? $class = 'class="even"' : $class = 'class="odd"';			if(!$ad['thumb0']) $ad['thumb0'] = '/images/icons/noimage.png';			if($ad['town']) $ad['location'] = $ad['town'].', '.$ad['country'].' '.$ad['xtraLocation'];			//$adList .= '<td valign="top" align="center"><a style="text-decoration:none;" title="$'.$ad['price'].': '.$ad['title'].'" href="/ad-'.$ad['id'].'"><img style="padding-bottom:10px;" border="0" alt="Thumbnail: '.$ad['title'].'" src="'.$ad['thumb0'].'"><br /><b>'.$ad['type'].' $'.number_format($ad['price'],2).':</b><br /> <span style="font-size:0.8em;">'.$ad['title'].'</span></a></td>';			$adList .= '			<tr '.$class.'>				<td rowspan="2" class="adImage"><a href="/ad-'.$ad['id'].'" target="">					<img src="'.$ad['thumb0'].'" />					'.($ad['status'] ? '<br /><img src="/images/icons/icon'.($ad['status'] == 1 ? 'pending' : 'sold').'.png" style="position:relative; margin-top:-75px;" />' : '').'				</a></td>				<td colspan="2" class="adTitle"><a href="/ad-'.$ad['id'].'" target="">'.$ad['title'].'</a></td>			</tr>			<tr '.$class.'>				<td class="adPrice">'.($ad['price'] != 0.00 ? '$'.number_format($ad['price'],2) : '').' '.$ad['priceType'].'</td>				<td class="adLocation">'.$ad['location'].'</td>			</tr>			';		}	}	if($adList) return(getAdListStyling().'<table class="adList">'.$adList.'</table>');}function classifiedsList($mode='simple',$params='') {	if($params) $_REQUEST += $params;		lfunc(_fnc.'adhandling');		//Apply filters to ad details	foreach($GLOBALS['adBox']['ads'] as $key=>$ad) {		if(!$ad) continue; //This item has been cleared by the pagination system		(($i++ % 2) == 0) ? $class = 'even' : $class = 'odd';				if($mode == 'simple') $classifieds .= '		<a href="'.$ad['url'].'" target="'.$ad['target'].'" class="adDiv '.$class.'">			<img alt="" src="'.$ad['thumb'].'" class="adImage" />			<div class="adTitle">'.$ad['title'].'</div>			<img src="/images/providers/ad'.$ad['aggregator'].'.png" class="adGraphic" />			<div class="adPrice">'.$ad['price'].' '.$ad['priceType'].'</div>		</a>		';				else $classifieds .= '		<tr class="'.$class.'">			<td rowspan="'.( $ad['specifics'] ? '3' : '2' ).'" class="adImage"><a href="'.$ad['url'].'" target="'.$ad['target'].'"><img alt="" src="'.$ad['thumb'].'" style="max-width:100px; max-height:75px;" /></a></td>			<td colspan="3" class="adTitle">				<div class="hoverTainer adGraphic">					<div class="trigger"><img src="/images/icons/adtools.png" /></div>					<div class="hoverBox llst">						<div class="header">Item Tools:</div>						'.($ad['location'] ? '							'.($_REQUEST['map'] ? '<a href="#map" onClick="markerOpen(\''.$ad['id'].'\');"><img src="/images/map/link.png" /> View on Map</a>' : '').'							<a href="/ad-'.encrypt($ad['id'],'url').'-tpl-earth'.($ad['aggregator'] != 'safarri' ? '-source-'.$ad['aggregator'] : '').'"><img src="/images/formats/earth.png" /> View in Google Earth</a>						' : '').'					</div>				</div>				<img src="/images/providers/ad'.$ad['aggregator'].'.png" class="adGraphic" />				<a class="title" href="'.$ad['url'].'" target="'.$ad['target'].'">'.$ad['title'].'</a>			</td>		</tr>		'.( $ad['specifics'] ? '<tr '.$class.'><td colspan="3" class="adSpecs">'.$ad['specifics'].'</td></tr>' : '' ).'		<tr '.$class.'>			<td class="adPrice">'.$ad['price'].' '.$ad['priceType'].'</td>			<td class="adDate">'.$ad['date'].'</td>			<td class="adLocation">'.$ad['location'].'</td>		</tr>';	}	if($classifieds) {		if($mode == 'simple')	return(getAdListStyling().$classifieds);		else					return(getAdListStyling().'<table class="adList">'.$classifieds.'</table>');	}}function getAdListStyling() {	return '	<style type="text/css">		.adList { width:100%; border-spacing:0px; border-collapse:collapse; }		.adList .adDate, .adList .adPrice, .adList .adLocation, .adList .adImage, .adList .adSpecs { text-align:center; border-bottom:1px solid #999999; padding-top:5px; padding-bottom:5px; }		.adList .adTitle { border-bottom:1px solid #DDDDDD; text-align:center; }		.adList .adTitle>a { display: block; text-decoration:none; padding:7px; font-weight:bold;  }		.adList .adImage { height: 70px; padding:5px; width:1px; }		.adList .adSpecs { border-bottom:1px solid #DDDDDD; color:#555555; font-size: 11px; padding:4px; }		.adList .adSpecs .spec { color:#999999; }		.adList .adPrice { font-weight:bold; white-space:nowrap; }		.adList .adDate { width:30%; }		.adList .adLocation { font-size: 11px; }		.adList .adSeperator, .adSeperator a { color:#0033CC; font-size:9px; line-height:14px; background-color:#F1F1F1; border-top-width:0px; }		.adList .adSeperator a { font-style:italic; }		.adList .adSeperator a:hover { background:none; }		.adList .adGraphic { float:right; padding-top:7px; }				.adDiv { display:block; height:70px; text-decoration:none; border-bottom:1px solid #999999; }		.adDiv:hover { text-decoration:none; }		.adDiv .adImage { height: 70px; padding-right:5px; float:left; }		.adDiv .adTitle { height:45px; margin-top:5px; font-size:1.1em; }		.adDiv .adGraphic { float:right; }		.adDiv .adPrice { font-weight:bold; }		.adImage { max-width:100px; max-height:75px; }				.adCats { width:100%; overflow:hidden; text-align:left; padding-left:20px; }		.adCat { text-decoration:none; display:block; float:left; width:165px; } .adCat:hover { text-decoration:none; }		.adCat span { padding:2px; margin-left:30px; margin-right:5px; margin-top:5px; display:block; width:124px; }		.adCat:hover span { padding:1px; background-color:#F1F1F1; border:1px solid #999999; cursor:pointer;}		.adCat img { vertical-align:middle; padding-right:7px; float:left; }	</style>	';}?>